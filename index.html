// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ä¸€éµå»ºç«‹å­¸ç”Ÿåå–®è…³æœ¬
// ä½¿ç”¨æ–¹å¼ï¼š
//   1. é–‹å•Ÿ https://019cp.github.io/gradelookup/
//   2. ç”¨è€å¸«å¸³è™Ÿç™»å…¥ï¼ˆé€²å…¥ç®¡ç†ä»‹é¢ï¼‰
//   3. æŒ‰ F12 é–‹å•Ÿé–‹ç™¼è€…å·¥å…· â†’ é»ã€ŒConsoleã€åˆ†é 
//   4. æŠŠä»¥ä¸‹å…¨éƒ¨ç¨‹å¼ç¢¼è²¼ä¸Šå» â†’ æŒ‰ Enter
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(async () => {
  // å¾é é¢å·²è¼‰å…¥çš„ Firebase å–å¾— Firestore
  const { getFirestore, doc, setDoc } = await import(
    "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js"
  );
  const { getApp } = await import(
    "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js"
  );

  const db = getFirestore(getApp());

  const DOMAIN   = "@tpjh.kh.edu.tw";
  const CLASS_1  = "804";
  const CLASS_2  = "804";
  const SEMESTER = "113-2";

  const students = [
    // 131ç­
    { id: "1310402", name: "å³å®¥ç£¬",  cls: CLASS_1 },
    { id: "1310403", name: "æ—ç¾¿å®‡",  cls: CLASS_1 },
    { id: "1310404", name: "è¨±æµ©ç‘‹",  cls: CLASS_1 },
    { id: "1310405", name: "é»ƒå¡å´´",  cls: CLASS_1 },
    { id: "1310406", name: "èƒ¡æ›¸è±ª",  cls: CLASS_1 },
    { id: "1310407", name: "é¾æ™ºå´´",  cls: CLASS_1 },
    { id: "1310408", name: "æ—å¾‹è¡¡",  cls: CLASS_1 },
    { id: "1310409", name: "æ—æ˜¶å¸Œ",  cls: CLASS_1 },
    { id: "1310410", name: "è”¡æ‰¿è«­",  cls: CLASS_1 },
    { id: "1310411", name: "è¨±è­¯å…ƒ",  cls: CLASS_1 },
    { id: "1310412", name: "çŸ³æ˜“ç”³",  cls: CLASS_1 },
    { id: "1310413", name: "é™³æ—»ç…¥",  cls: CLASS_1 },
    { id: "1310414", name: "è©¹ç‰éŒ¦",  cls: CLASS_1 },
    { id: "1310416", name: "åŠ‰æ²›ç’‹",  cls: CLASS_1 },
    // 132ç­
    { id: "1320426", name: "æå®¥è±",  cls: CLASS_2 },
    { id: "1320427", name: "æ´ªé–èŒ¹",  cls: CLASS_2 },
    { id: "1320428", name: "æœ±ç´«éˆº",  cls: CLASS_2 },
    { id: "1320429", name: "èŠå–¬å®‰",  cls: CLASS_2 },
    { id: "1320430", name: "é»ƒå®£æ™´",  cls: CLASS_2 },
    { id: "1320431", name: "å³æ½”æ±",  cls: CLASS_2 },
    { id: "1320432", name: "ä½•æ¯“å©•",  cls: CLASS_2 },
    { id: "1320433", name: "äºè‰å©•",  cls: CLASS_2 },
    { id: "1320434", name: "é‚±é–æ·³",  cls: CLASS_2 },
    { id: "1320435", name: "èŒƒéœéŠ€",  cls: CLASS_2 },
    { id: "1320436", name: "è¨±è­¯äº‘",  cls: CLASS_2 },
    { id: "1320437", name: "å‘‚å®‡å©•",  cls: CLASS_2 },
    { id: "1320438", name: "èŠæƒŸæ™´",  cls: CLASS_2 },
    { id: "1320439", name: "ï¼ˆå¾…è£œï¼‰", cls: CLASS_2 },
  ];

  let ok = 0, fail = 0;
  for (const s of students) {
    const email = s.id + DOMAIN;
    const docId = email.replace(/[^a-z0-9]/g, "_");
    try {
      await setDoc(doc(db, "students", docId), {
        email,
        name:     s.name,
        class:    s.cls,
        semester: SEMESTER,
        rank:     "",
        subjects: []          // æˆç¸¾å…ˆç©ºç™½ï¼Œä¹‹å¾Œåœ¨ç®¡ç†ä»‹é¢å¡«å…¥
      });
      console.log(`âœ… ${s.name} (${email})`);
      ok++;
    } catch(e) {
      console.error(`âŒ ${s.name} å¤±æ•—:`, e.message);
      fail++;
    }
  }

  console.log(`\nğŸ‰ å®Œæˆï¼æˆåŠŸ ${ok} ç­† / å¤±æ•— ${fail} ç­†`);
  console.log("è«‹é‡æ–°æ•´ç†é é¢ï¼Œç®¡ç†ä»‹é¢å³å¯çœ‹åˆ°æ‰€æœ‰å­¸ç”Ÿã€‚");
})();
